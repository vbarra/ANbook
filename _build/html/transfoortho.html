
<!DOCTYPE html>

<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Transformations orthogonales &#8212; Analyse numérique</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script src="_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Recherche" href="search.html" />
    <link rel="next" title="Exercices" href="exomcl.html" />
    <link rel="prev" title="Moindres carrés linéaires" href="mcl.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="fr">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/isimainp.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Analyse numérique</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p class="caption">
 <span class="caption-text">
  Tutoriels
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Installation.html">
   Requirement
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Tutoriel-jupyter.html">
   Tutoriel Jupyter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Tutoriel-numpy.html">
   Tutoriel Numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Tutoriel-matplotlib.html">
   Tutoriel Matplotlib
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Introduction au calcul matriciel
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ev.html">
   Espaces Vectoriels
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="matrices.html">
   Matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sl.html">
   Systèmes d’équations linéaires
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ch1exos.html">
   Exercices
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Elimination de Gauss
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ch2.html">
   Gauss et LU
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gauss.html">
   Elimination de Gauss
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lu.html">
   Facteurs LU d’une matrice non singulière
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Moindres carrés linéaires
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="projections.html">
   Projections orthogonales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mcl.html">
   Moindres carrés linéaires
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Transformations orthogonales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exomcl.html">
   Exercices
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Analyse spectrale
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="introspect.html">
   Moindres carrés linéaires
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="resspec.html">
   Moindres carrés linéaires
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="similitudes.html">
   Moindres carrés linéaires
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="jacobi.html">
   Moindres carrés linéaires
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="puissiter.html">
   Moindres carrés linéaires
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="QRspec.html">
   Moindres carrés linéaires
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Index
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="genindex.html">
   Index
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/vbarra/anbook.git"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/vbarra/anbook.git/issues/new?title=Issue%20on%20page%20%2Ftransfoortho.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/transfoortho.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="_sources/transfoortho.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matrices-orthogonales">
   Matrices orthogonales
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#orthogonalisation-de-gram-schmidt">
   Orthogonalisation de Gram-Schmidt
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algorithme">
     Algorithme
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gram-schmidt-sur-mathbb-r-n">
     Gram-Schmidt sur
     <span class="math notranslate nohighlight">
      \(\mathbb{R}^n\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#retour-sur-le-probleme-aux-moindres-carres">
     Retour sur le problème aux moindres carrés
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transformations-de-householder">
   Transformations de Householder
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Transformations orthogonales</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matrices-orthogonales">
   Matrices orthogonales
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#orthogonalisation-de-gram-schmidt">
   Orthogonalisation de Gram-Schmidt
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algorithme">
     Algorithme
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gram-schmidt-sur-mathbb-r-n">
     Gram-Schmidt sur
     <span class="math notranslate nohighlight">
      \(\mathbb{R}^n\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#retour-sur-le-probleme-aux-moindres-carres">
     Retour sur le problème aux moindres carrés
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transformations-de-householder">
   Transformations de Householder
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="transformations-orthogonales">
<h1>Transformations orthogonales<a class="headerlink" href="#transformations-orthogonales" title="Lien permanent vers ce titre">#</a></h1>
<div class="section" id="matrices-orthogonales">
<h2>Matrices orthogonales<a class="headerlink" href="#matrices-orthogonales" title="Lien permanent vers ce titre">#</a></h2>
<div class="proof definition admonition" id="definition-0">
<p class="admonition-title"><span class="caption-number">Definition 28 </span> (Matrice orthogonale)</p>
<div class="definition-content section" id="proof-content">
<p>Une matrice carrée <span class="math notranslate nohighlight">\({\bf H}\)</span> est dite {orthogonale}
si et seulement si <span class="math notranslate nohighlight">\({\bf H^\top}{\bf H}={\bf H}{\bf H^\top} = \mathbb I\)</span></p>
</div>
</div><span class="target" id="index-0"></span><p id="index-1">Une matrice orthogonale est donc une matrice carrée dont les colonnes sont orthonormées. Les matrices de rotation, de symétrie, de permutation et l’identité sont des exemples de matrices orthogonales.</p>
<p>Une matrice orthogonale <span class="math notranslate nohighlight">\({\bf H}\)</span> est naturellement inversible par définition, et l’inverse est <span class="math notranslate nohighlight">\({\bf H^{-1}}={\bf H^\top} \)</span>.</p>
<div class="proof property admonition" id="property-1">
<p class="admonition-title"><span class="caption-number">Property 11 </span> (Propriété fondamentale)</p>
<div class="property-content section" id="proof-content">
<p>Les transformations orthogonales
sont des isométries, les normes (euclidiennes), les produits scalaires et les angles sont conservés :</p>
<p><span class="math notranslate nohighlight">\(({\bf H} \textrm{ orthogonale}) \Leftrightarrow (\forall {\bf x}\in \mathbb R^n)\\|{\bf Hx}\|=\|{\bf x}\|\)</span></p>
</div>
</div><span class="target" id="index-2"></span><p id="index-3">En effet, <span class="math notranslate nohighlight">\(\|{\bf Hx}\|^2=({\bf Hx)^\top} ({\bf Hx})={\bf x^\top H^\top Hx}={\bf x^\top x}=\|{\bf x}\|^2\)</span>.</p>
<p>Cette propriété entraîne une stabilité numérique des méthodes utilisant ces transformations. On les utilise principalement pour :</p>
<ul class="simple">
<li><p>orthonormaliser un système de générateurs,</p></li>
<li><p>résoudre un systèmes aux équations normales,</p></li>
<li><p>triangulariser un système mal conditionné,</p></li>
<li><p>calculer les valeurs propres d’une matrice.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">init_printing</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">Rational</span>

<span class="n">Q</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">Q</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">Q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}1 &amp; 0 &amp; 0\\0 &amp; 1 &amp; 0\\0 &amp; 0 &amp; 1\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)],</span> <span class="p">[</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)]])</span>
<span class="n">R</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">R</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}\sin^{2}{\left(\theta \right)} + \cos^{2}{\left(\theta \right)} &amp; 0\\0 &amp; \sin^{2}{\left(\theta \right)} + \cos^{2}{\left(\theta \right)}\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>Si les colonnes sont orthogonales mais pas normées, la matrice n’est pas orthogonale</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">Q</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">Q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}2 &amp; 0\\0 &amp; 2\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>Il est cependant facile de les normer pour obtenir une base orthonormée de <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span></p>
<p><span class="math notranslate nohighlight">\(\sqrt { { \left( 1 \right)  }^{ 2 }+{ \left( 1 \right)  }^{ 2 } } =\sqrt { 2 } \\ \sqrt { { \left( 1 \right)  }^{ 2 }+{ \left( -1 \right)  }^{ 2 } } =\sqrt { 2 }\)</span>
<span class="math notranslate nohighlight">\(Q=\frac { 1 }{ \sqrt { 2 }  } \begin{bmatrix} 1 &amp; 1 \\ 1 &amp; -1 \end{bmatrix}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">Q</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}\frac{\sqrt{2}}{2} &amp; \frac{\sqrt{2}}{2}\\\frac{\sqrt{2}}{2} &amp; - \frac{\sqrt{2}}{2}\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>Soit <span class="math notranslate nohighlight">\({\bf Q}\in\mathcal{M}_n(\mathbb R)\)</span> orthogonale, de colonnes
<span class="math notranslate nohighlight">\({\bf q_1},{\bf q_2},\ldots,{\bf q_n}\)</span>. On a alors, pour tout <span class="math notranslate nohighlight">\({\bf x}\in\mathbb R^n\)</span>, une représentation unique sur la base
orthonormée telle que</p>
<p><span class="math notranslate nohighlight">\({\bf x}=\displaystyle\sum_{i=1}^n ({\bf q_i^\top} {\bf x}){\bf q_i}\)</span></p>
<p><span class="math notranslate nohighlight">\(({\bf q_i^\top} {\bf x}){\bf q_i}\)</span> est la projection orthogonale de <span class="math notranslate nohighlight">\({\bf x}\)</span> sur l’axe <span class="math notranslate nohighlight">\({\bf q_i}\)</span>. Cette représentation se
généralise aisement à une base orthonormée quelconque <span class="math notranslate nohighlight">\({\bf q_1},{\bf q_2},\ldots,{\bf q_r}\)</span> d’un sous-espace de dimension <span class="math notranslate nohighlight">\(r\)</span>.</p>
</div>
<div class="section" id="orthogonalisation-de-gram-schmidt">
<h2>Orthogonalisation de Gram-Schmidt<a class="headerlink" href="#orthogonalisation-de-gram-schmidt" title="Lien permanent vers ce titre">#</a></h2>
<span class="target" id="index-4"></span><div class="section" id="algorithme">
<span id="index-5"></span><h3>Algorithme<a class="headerlink" href="#algorithme" title="Lien permanent vers ce titre">#</a></h3>
<p>A partir d’une famille de <span class="math notranslate nohighlight">\(p\)</span> vecteurs linéairement indépendants de <span class="math notranslate nohighlight">\(\mathbb R^n\)</span>, représentés par une matrice <span class="math notranslate nohighlight">\({\bf A}\in\mathcal{M}_{n,p}(\mathbb R)\)</span> de rang <span class="math notranslate nohighlight">\(p\)</span>, on peut construire une famille <span class="math notranslate nohighlight">\(\{{\bf q_1}\cdots {\bf q_p}\}\)</span>, base orthonormée de <span class="math notranslate nohighlight">\(Im({\bf A})\)</span>. C’est un outil fondamental pour la résolution de systèmes surdéterminés.</p>
<p>L’idée générale est donc de construire une base orthonormée du sous-espace image d’un ensemble de vecteurs. L’intérêt numérique est que cette construction équivaut à triangulariser la matrice formée par ces vecteurs. L’algorithme <a class="reference internal" href="#GS">Algorithm 5</a> et la figure suivante présentent le procédé d’orthonormalisation de Gram-Schmidt qui, s’il est simple à comprendre, ne présente qu’un intérêt académique puisqu’il est très coûteux. En pratique, on utilise la méthode de factorisation QR qui permet d’atteindre le même objectif grâce à des transformations orthogonales élémentaires (rotations de Givens ou transformations de  Householder) numériquement stables et seulement deux fois plus chères que la méthode de Gauss.</p>
<p>Le principe de Gram-Schmidt est de calculer, pour <span class="math notranslate nohighlight">\(j\in[\![2,p]\!]\)</span>,  chaque vecteur <span class="math notranslate nohighlight">\({\bf q_j}\)</span> en soustrayant à  <span class="math notranslate nohighlight">\({\bf  A_{\bullet,j}}\)</span> ses projections orthogonales sur les <span class="math notranslate nohighlight">\(j-1\)</span>
premiers vecteurs de la base orthonormée déjà calculés, puis en normant le résultat.</p>
<div class="proof algorithm admonition" id="GS">
<p class="admonition-title"><span class="caption-number">Algorithm 5 </span> (Procédé d’orthonormalisation de Gram-Schmidt - version de base)</p>
<div class="algorithm-content section" id="proof-content">
<p>**Entrée : **  <span class="math notranslate nohighlight">\({\bf A}\in\mathcal{M}_{n,p}(\mathbb R)\)</span> de rang <span class="math notranslate nohighlight">\(p\)</span></p>
<p>**Sortie : ** <span class="math notranslate nohighlight">\({\bf Q_1}\in\mathcal{M}_{n,p}(\mathbb R)\)</span> à colonnes orthonormées, <span class="math notranslate nohighlight">\({\bf R_1}\in\mathcal{M}_{p}(\mathbb R)\)</span> triangulaire supérieure</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(r_{11} = \\{\bf A_{\bullet,1}}\|\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\({\bf q_{{1}}} = \frac{{\bf A_{\bullet,1}}}{r_{11}}\)</span></p></li>
<li><p>Pour <span class="math notranslate nohighlight">\(j\)</span>=2 à <span class="math notranslate nohighlight">\(p\)</span></p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\({\bf p_j}={\bf A_{\bullet,j}}\)</span></p></li>
<li><p>Pour <span class="math notranslate nohighlight">\(i\)</span>=1 à <span class="math notranslate nohighlight">\(j-1\)</span></p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(r_{ij}={\bf A_{\bullet,j}^\top}{\bf q_{{i}}}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\({\bf p_j}={\bf p_j}- r_{ij}{\bf q_{{i}}}\)</span></p></li>
</ol>
</li>
<li><p><span class="math notranslate nohighlight">\(r_{jj} = \|{\bf p_j}\|\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\({\bf q_{{j}}} = \frac{{\bf p_j}}{r_{jj}}\)</span></p></li>
</ol>
</li>
</ol>
</div>
</div><p><img alt="" src="_images/gs.png" /></p>
<p>On remarque (voir boucles de l’algorithme) que la matrice <span class="math notranslate nohighlight">\({\bf R_1}\)</span> est triangulaire supérieure.</p>
<p>Gram-Schmidt construit donc une matrice <span class="math notranslate nohighlight">\({\bf Q_1}\in\mathcal{M}_{n,p}(\mathbb R)\)</span> à colonnes orthormées et une matrice <span class="math notranslate nohighlight">\({\bf R_1}\in\mathcal{M}_{p}(\mathbb R)\)</span> telles que <span class="math notranslate nohighlight">\({\bf Q_1^\top}{\bf A} = {\bf R_1}\)</span> soit <span class="math notranslate nohighlight">\({\bf A}\)</span>=<span class="math notranslate nohighlight">\({\bf Q_1R_1}\)</span>.</p>
<div class="proof example admonition" id="example-3">
<p class="admonition-title"><span class="caption-number">Example 13 </span></p>
<div class="example-content section" id="proof-content">
<p>Soit <span class="math notranslate nohighlight">\({\bf A} = \begin{pmatrix} 1&amp;1\\1&amp;0\\1&amp;1\end{pmatrix}\)</span>.</p>
<p>Alors <span class="math notranslate nohighlight">\({\bf A} ={\bf QR}\)</span> avec <span class="math notranslate nohighlight">\({\bf Q} = \begin{pmatrix} \textcolor{blue}{\frac{1}{\sqrt{3}}}&amp;\textcolor{magenta}{\frac{1}{\sqrt{6}}}\\\textcolor{blue}{\frac{1}{\sqrt{3}}}&amp;\textcolor{magenta}{-\frac{\sqrt 2}{\sqrt 3}}\\\textcolor{blue}{\frac{1}{\sqrt{3}}}&amp;\textcolor{magenta}{\frac{1}{\sqrt{6}}}\end{pmatrix}\)</span> et <span class="math notranslate nohighlight">\({\bf R} = \begin{pmatrix} \textcolor{red}{\sqrt{3}}&amp;\textcolor{orange}{\frac{2}{\sqrt{3}}}\\0&amp;\textcolor{cyan}{\sqrt{\frac{2}{3}}}\end{pmatrix}\)</span>. En effet :</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\textcolor{red}{r_{11}} = \|{\bf A_{\bullet,1}}\| = \textcolor{red}{\sqrt{3}}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\textcolor{blue}{{\bf q_{1}}}= \frac{1}{\sqrt{3}}{\bf A_{\bullet,1}}= \textcolor{blue}{\frac{1}{\sqrt{3}}\begin{pmatrix}1\\1\\1\end{pmatrix}}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\textcolor{orange}{r_{12}}={\bf A_{\bullet,2}^\top q_1}=\begin{pmatrix}1&amp;0&amp;1\end{pmatrix}.\frac{1}{\sqrt{3}}\begin{pmatrix}1\\1\\1\end{pmatrix} =  \textcolor{orange}{\frac{2}{\sqrt{3}}}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\({\bf p_2}={\bf A_{\bullet,2}}- r_{12}{\bf q_{{1}}}=\begin{pmatrix}1\\0\\1\end{pmatrix}-\frac{2}{\sqrt{3}}.\frac{1}{\sqrt{3}}\begin{pmatrix}1\\1\\1\end{pmatrix}=\begin{pmatrix}\frac{1}{3}\\-\frac{2}{3}\\\frac{1}{3}\end{pmatrix}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\textcolor{cyan}{r_{22}} = \|{\bf p_2}\|= \textcolor{cyan}{\sqrt{\frac{2}{3}}}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\textcolor{magenta}{{\bf q_{2}}} = \frac{{\bf p_2}}{r_{22}} = \textcolor{magenta}{\begin{pmatrix}\frac{1}{\sqrt{6}}\\-\frac{\sqrt 2}{\sqrt 3}\\\frac{1}{\sqrt{6}}\end{pmatrix}}\)</span></p></li>
</ol>
</div>
</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">GramSchmidt</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> 
    <span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">])</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>     
        <span class="n">p</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>  
            <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Q</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">A</span><span class="p">[:,</span><span class="n">j</span><span class="p">])</span>
            <span class="n">p</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">Q</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span>
        
        <span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">p</span><span class="p">[:,</span><span class="n">j</span><span class="p">],</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">Q</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">R</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>             
    
    <span class="k">return</span> <span class="n">Q</span><span class="p">,</span> <span class="n">R</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">GramSchmidt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A=&quot;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Q=&quot;</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;R=&quot;</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Q^TQ=&quot;</span><span class="p">,</span><span class="n">Q</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@Q</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># On vérifie à quel point Q est orthogonale</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Q^TQ=&quot;</span><span class="p">,</span><span class="n">Q</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@Q</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Norme de I-Q^TQ = &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">))))</span>

<span class="c1">#On vérifie à quel point A=QR</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Norme infinie de QR-A = &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="n">R</span><span class="p">)</span><span class="o">-</span><span class="n">A</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A= [[0.3196 0.8541 0.8395 0.4483]
 [0.2448 0.0356 0.2062 0.9   ]
 [0.194  0.4086 0.4197 0.0707]
 [0.8113 0.6506 0.0762 0.5429]] 

Q= [[ 0.345   0.8267  0.1557  0.4162]
 [ 0.2643 -0.3447  0.891   0.1322]
 [ 0.2095  0.3281  0.1982 -0.8995]
 [ 0.8759 -0.3001 -0.3776  0.0113]] 

R= [[ 0.9263  0.9596  0.4988  0.8829]
 [ 0.      0.6327  0.7378 -0.0793]
 [ 0.      0.      0.3689  0.6807]
 [ 0.      0.      0.      0.2481]] 

Q^TQ= [[ 1.0000e+00  2.8168e-16 -5.8837e-16  2.2391e-15]
 [ 2.8168e-16  1.0000e+00 -9.1131e-16  1.1467e-15]
 [-5.8837e-16 -9.1131e-16  1.0000e+00  1.8753e-15]
 [ 2.2391e-15  1.1467e-15  1.8753e-15  1.0000e+00]] 

Q^TQ= [[ 1.0000e+00  2.8168e-16 -5.8837e-16  2.2391e-15]
 [ 2.8168e-16  1.0000e+00 -9.1131e-16  1.1467e-15]
 [-5.8837e-16 -9.1131e-16  1.0000e+00  1.8753e-15]
 [ 2.2391e-15  1.1467e-15  1.8753e-15  1.0000e+00]] 

Norme de I-Q^TQ =  2.239129055729072e-15
Norme infinie de QR-A =  1.1102230246251565e-16
</pre></div>
</div>
</div>
</div>
<p>Suivant la matrice <span class="math notranslate nohighlight">\(\bf A\)</span>, la méthode de Gram-Schmidt classique précédente peut être instable.</p>
<p>Considérons par exemple la matrice suivante, dite matrice de Hilbert</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Hilbert</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">A</span>
</pre></div>
</div>
</div>
</div>
<p>On applique la méthode de Gram-Schmidt, et on vérifie à quel point <span class="math notranslate nohighlight">\(\bf QR\)</span> est proche de <span class="math notranslate nohighlight">\(\bf A\)</span>, et <span class="math notranslate nohighlight">\(\bf Q\)</span> est orthogonale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">Hilbert</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">GramSchmidt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Norme de QR-A = &#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="n">R</span><span class="p">)</span><span class="o">-</span><span class="n">A</span><span class="p">)),</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Norme de Q^T*Q-I = &quot;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Norme de QR-A =  5.551115123125783e-17 

Norme de Q^T*Q-I =  0.9999670638304938
</pre></div>
</div>
</div>
</div>
<p>La factorisation est précise, mais <span class="math notranslate nohighlight">\(\bf Q\)</span> est loin d’être orthogonale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 2.2204e-16 -7.1907e-16  2.1061e-16  1.2854e-13 -3.8781e-12  6.2623e-11
   9.3604e-10 -1.1228e-09]
 [-7.1907e-16 -1.1102e-16  3.3479e-14 -3.8756e-13  2.9006e-12 -4.7162e-12
  -7.8626e-10  8.3957e-10]
 [ 2.1061e-16  3.3479e-14 -2.2204e-16 -7.5044e-12  1.8006e-10 -3.3977e-09
   6.5369e-08 -6.7247e-08]
 [ 1.2854e-13 -3.8756e-13 -7.5044e-12 -2.2204e-16  5.2271e-09 -2.0147e-07
   6.2067e-06 -6.4720e-06]
 [-3.8781e-12  2.9006e-12  1.8006e-10  5.2271e-09 -1.1102e-16 -1.1055e-05
   7.0152e-04 -7.4979e-04]
 [ 6.2623e-11 -4.7162e-12 -3.3977e-09 -2.0147e-07 -1.1055e-05  0.0000e+00
   5.7672e-02 -6.5681e-02]
 [ 9.3604e-10 -7.8626e-10  6.5369e-08  6.2067e-06  7.0152e-04  5.7672e-02
  -3.3307e-16 -9.9997e-01]
 [-1.1228e-09  8.3957e-10 -6.7247e-08 -6.4720e-06 -7.4979e-04 -6.5681e-02
  -9.9997e-01  0.0000e+00]]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="gram-schmidt-sur-mathbb-r-n">
<h3>Gram-Schmidt sur <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span><a class="headerlink" href="#gram-schmidt-sur-mathbb-r-n" title="Lien permanent vers ce titre">#</a></h3>
<p>Il est possible de compléter <span class="math notranslate nohighlight">\({\bf q_1}\cdots {\bf q_p}\)</span> en une base orthonormée de <span class="math notranslate nohighlight">\(\mathbb R^n\)</span>, en continuant la procédure de Gram-Schmidt avec <span class="math notranslate nohighlight">\(n-p\)</span> vecteurs arbitraires, mais tels que les <span class="math notranslate nohighlight">\(n\)</span> colonnes formées avec les <span class="math notranslate nohighlight">\({\bf A_{\bullet,j}}\)</span> soient linéairement indépendantes. Soit <span class="math notranslate nohighlight">\({\bf Q_2}\)</span> la matrice des <span class="math notranslate nohighlight">\(n-p\)</span> derniers vecteurs orthonormés. On a alors bien :</p>
<p><span class="math notranslate nohighlight">\({\bf A^\top} {\bf Q_2}={\bf R_1^\top} {\bf Q_1^\top} {\bf Q_2}=0\)</span> ce qui montre que :</p>
<p><span class="math notranslate nohighlight">\({\bf A}={\bf QR}=[{\bf Q_1}\ {\bf Q_2}]\cdot\left [\begin{array}{c}{\bf R_1} \\{\bf 0} \\\end{array}\right]={\bf Q_1R_1}\)</span>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Les colonnes de <span class="math notranslate nohighlight">\({\bf Q_1}\)</span> forment une base orthonormée de <span class="math notranslate nohighlight">\(Im({\bf A})\)</span>, et les colonnes de <span class="math notranslate nohighlight">\({\bf Q_2}\)</span> forment
une base orthonormée de <span class="math notranslate nohighlight">\(Ker({\bf A^\top})\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">Q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}\frac{1}{3} &amp; - \frac{2}{3}\\\frac{2}{3} &amp; - \frac{1}{3}\\\frac{2}{3} &amp; \frac{2}{3}\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>Les colonnes de <span class="math notranslate nohighlight">\(Q\)</span> forment une base de <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> (dans <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>). Pour obtenir une matrice orthogonale, il faut compléter par un vecteur normal au plan défini par ces deux colonnes, et unitaire.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">Q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}\frac{1}{3} &amp; - \frac{2}{3} &amp; \frac{2}{3}\\\frac{2}{3} &amp; - \frac{1}{3} &amp; - \frac{2}{3}\\\frac{2}{3} &amp; \frac{2}{3} &amp; \frac{1}{3}\end{matrix}\right]\end{split}\]</div>
</div>
</div>
</div>
<div class="section" id="retour-sur-le-probleme-aux-moindres-carres">
<h3>Retour sur le problème aux moindres carrés<a class="headerlink" href="#retour-sur-le-probleme-aux-moindres-carres" title="Lien permanent vers ce titre">#</a></h3>
<p>Appliqué au problème des moindres carrés, le système aux équations normales s’écrit donc</p>
<p><span class="math notranslate nohighlight">\(\begin{eqnarray*}
{\bf A^\top Ax}&amp;=&amp; {\bf A^\top b}\\
{\bf (Q_1R_1)^\top (Q_1R_1)x}&amp;=&amp; {\bf (Q_1R_1)^\top b}\\
{\bf R_1^\top Q_1^\top Q_1R_1x}&amp;=&amp; {\bf R_1^\top Q_1^\top b}\\
{\bf R_1^\top R_1x}&amp;=&amp; {\bf R_1^\top Q_1^\top b}\\
{\bf R_1x}&amp;=&amp; {\bf Q_1^\top b}
\end{eqnarray*}\)</span></p>
<p>La dernière simplification étant possible car <span class="math notranslate nohighlight">\({\bf R_1}\)</span> est inversible (trangulaire supérieure, les éléments de la diagonale étant des normes, donc strictement positifs). La solution du
problème des moindres carrés est solution du système triangulaire</p>
<p><span class="math notranslate nohighlight">\({\bf R_1x}= {\bf Q_1^\top b}\)</span>
et le calcul de l’erreur donne</p>
<p><span class="math notranslate nohighlight">\(\|{\bf e}\|^2=\|{\bf b}\|^2-\displaystyle\sum_{i=1}^p  ({\bf b^\top} {\bf q_i})^2\)</span></p>
</div>
</div>
<div class="section" id="transformations-de-householder">
<h2>Transformations de Householder<a class="headerlink" href="#transformations-de-householder" title="Lien permanent vers ce titre">#</a></h2>
<p id="index-6">On peut interpréter la méthode de Gram-Schmidt comme une méthode de triangularisation de la matrice <span class="math notranslate nohighlight">\({\bf A}\)</span>, au même titre que la méthode de Gauss. Il est possible de réorganiser les calculs en construisant des transformations élémentaires orthogonales qui effectuent cette triangularisation colonne par colonne (ou élément par élément). Les symétries de Householder
et les rotations de Givens sont des exemples simples et intéressants de telles transformations, car elles conduisent à des algorithmes numériquement plus stables que la méthode de Gram-Schmidt.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><img alt="" src="_images/householder.png" /></p>
</div>
<div class="proof definition admonition" id="definition-4">
<p class="admonition-title"><span class="caption-number">Definition 29 </span> (Matrice de Householder)</p>
<div class="definition-content section" id="proof-content">
<p>Une matrice de Householder
est une matrice carrée <span class="math notranslate nohighlight">\({\bf H}\)</span> qui s’écrit <span class="math notranslate nohighlight">\({\bf H}=\mathbb I-2{\bf P}\)</span>, où <span class="math notranslate nohighlight">\({\bf P}\)</span> est
la matrice de projection
sur la droite engendrée par un vecteur <span class="math notranslate nohighlight">\({\bf v}\)</span> non nul.</p>
</div>
</div><span class="target" id="index-7"></span><p id="index-8">On vérifie  que <span class="math notranslate nohighlight">\({\bf H}\)</span> représente une symétrie
par rapport au sous-espace <span class="math notranslate nohighlight">\({\bf v^\perp}\)</span>.</p>
<p id="index-9">Le théorème suivant montre qu’il est toujours possible de trouver une matrice de Householder
permettant de transformer un vecteur quelconque en un vecteur colinéaire à un vecteur donné.</p>
<div class="proof theorem admonition" id="theorem-5">
<p class="admonition-title"><span class="caption-number">Theorem 7 </span></p>
<div class="theorem-content section" id="proof-content">
<p>Soient <span class="math notranslate nohighlight">\({\bf f}\)</span> et <span class="math notranslate nohighlight">\({\bf e}\)</span> deux vecteurs non colinéaires de <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>; avec <span class="math notranslate nohighlight">\(\|{\bf e}\|_2=1\)</span>. Il est alors possible de trouver <span class="math notranslate nohighlight">\({\bf u}\in \mathbb{R}^n\)</span> tel que :</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(\|{\bf u}\|_2=1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\({\bf H(u)f}=\alpha {\bf e}\)</span></p></li>
</ol>
</div>
</div><div class="proof admonition" id="proof">
<p>Proof. Remarquons tout d’abord que si <span class="math notranslate nohighlight">\({\bf H(u)}\)</span> est une matrice de Householder, alors <span class="math notranslate nohighlight">\({\bf H(u)f}={\bf f-2u(u^\top f)}\)</span> et <span class="math notranslate nohighlight">\(\|{\bf H(u)f}\|_2=\|{\bf f}\|_2\)</span>.</p>
<p>Posons alors <span class="math notranslate nohighlight">\(\mid\alpha\mid=\|{\bf f}\|_2\)</span>. On cherche alors <span class="math notranslate nohighlight">\({\bf u}\)</span> tel que <span class="math notranslate nohighlight">\({\bf H(u)f}=\alpha {\bf e}\)</span>, soit</p>
<p><span class="math notranslate nohighlight">\(\begin{align*}
{\bf f-2u(u^\top f)}&amp;=\alpha {\bf e}\\
{\bf u}&amp;=\frac{1}{2{\bf u^\top f}}({\bf f-}\alpha {\bf e})
\end{align*}\)</span></p>
<p>Si <span class="math notranslate nohighlight">\(\beta={\bf u^\top f}\)</span>, en multipliant à gauche par <span class="math notranslate nohighlight">\({\bf f^\top} \)</span> :
<span class="math notranslate nohighlight">\(2\beta^2=\alpha^2-\alpha {\bf f^\top e}\)</span></p>
<p>et <span class="math notranslate nohighlight">\(\beta\)</span> existe si <span class="math notranslate nohighlight">\(\alpha^2-\alpha {\bf f^\top e}&gt;0\)</span>. Or l’inégalité de Cauchy-Schwarz donne</p>
<p><span class="math notranslate nohighlight">\(\mid {\bf f^\top e}\mid\leq\|{\bf f}\|_2\|{\bf e}\|_2=\|\alpha\|\)</span></p>
<p>et l’inégalité est de plus stricte par hypothèse (<span class="math notranslate nohighlight">\({\bf f}\)</span> et <span class="math notranslate nohighlight">\({\bf e}\)</span> non colinéaires). Ainsi :</p>
<p><span class="math notranslate nohighlight">\({\bf u}=\frac{1}{2\beta}({\bf f}-\alpha {\bf e)}\)</span> répond à la question.</p>
</div>
<div class="proof remark dropdown admonition" id="remark-6">
<p class="admonition-title"><span class="caption-number">Remark 9 </span></p>
<div class="remark-content section" id="proof-content">
<p>Si <span class="math notranslate nohighlight">\({\bf f}\)</span> et <span class="math notranslate nohighlight">\({\bf  e}\)</span> sont colinéaires, <span class="math notranslate nohighlight">\({\bf H}=\mathbb I\)</span> ou <span class="math notranslate nohighlight">\({\bf H}=\mathbb I-2{\bf ee^\top }\)</span> répondent à la question.</p>
</div>
</div><p>L’algorithme d’orthonormalisation  de <span class="math notranslate nohighlight">\({\bf A}\)</span> par matrices de Householder  opère alors colonne par colonne, et transforme itérativement <span class="math notranslate nohighlight">\({\bf A}\)</span> en une matrice triangulaire supérieure.</p>
<p>On l’illustre dans la suite (algorithme <a class="reference internal" href="#QR">Algorithm 6</a>) dans le cas où <span class="math notranslate nohighlight">\({\bf A}\in\mathcal{M}_n(\mathbb R)\)</span> est de rang plein.</p>
<div class="proof algorithm admonition" id="QR">
<p class="admonition-title"><span class="caption-number">Algorithm 6 </span> (Factorisation QR par matrices de Householder)</p>
<div class="algorithm-content section" id="proof-content">
<p>**Entrée : **  <span class="math notranslate nohighlight">\({\bf A}\in\mathcal{M}_n(\mathbb R)\)</span></p>
<p>**Sortie : **  <span class="math notranslate nohighlight">\({\bf Q}\in\mathcal{M}_n(\mathbb R)\)</span> orthogonale, <span class="math notranslate nohighlight">\({\bf R}\in\mathcal{M}_n(\mathbb R)\)</span> triangulaire supérieure</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\({\bf A^{(1)}}={\bf A}\)</span></p></li>
<li><p>Pour <span class="math notranslate nohighlight">\(j=1\)</span> à <span class="math notranslate nohighlight">\(n-1\)</span></p>
<ol class="simple">
<li><p>Soit <span class="math notranslate nohighlight">\({\bf f_j}\in \mathbb R^{n-j+1}\)</span> le vecteur commençant à l’élément <span class="math notranslate nohighlight">\((j,j)\)</span> de <span class="math notranslate nohighlight">\({\bf A^{(j)}}\)</span></p></li>
<li><p>On construit <span class="math notranslate nohighlight">\({\bf {\tilde H^{(j)}}}\in\mathcal{M}_{n-j+1}(\mathbb R)\)</span> telle que <span class="math notranslate nohighlight">\({\bf \tilde{H^{(j)}}f_j} = \|{\bf f_j}\ {\bf e^{(j)}_1}\)</span>, <span class="math notranslate nohighlight">\({\bf e^{(j)}_1}\)</span> premier vecteur de la base canonique de <span class="math notranslate nohighlight">\(\mathbb R^{n-j+1}\)</span></p></li>
<li><p>On construit
<img alt="" src="_images/h.png" /></p></li>
<li><p>On calcule <span class="math notranslate nohighlight">\({\bf A^{(j+1)}} = {{\bf H^{(j)}}\bf A^{(j)}}\)</span></p></li>
</ol>
</li>
<li><p><span class="math notranslate nohighlight">\({\bf R}={\bf A^{(n-1)}}\)</span> et <span class="math notranslate nohighlight">\({\bf Q} =  {\bf {H^{(1)}}^\top}{\bf {H^{(2)}}^\top} \cdots  {\bf {H^{(n-1)}}^\top}\)</span></p></li>
</ol>
</div>
</div><p>A l’issue des <span class="math notranslate nohighlight">\(n-1\)</span> itérations, on a effectué les produits <span class="math notranslate nohighlight">\({\bf H^{(n-1)}} \cdots {\bf H^{(2)}} {\bf H^{(1)}}\)</span> pour obtenir une matrice triangulaire supérieure <span class="math notranslate nohighlight">\({\bf R}\in\mathcal{M}_n(\mathbb R)\)</span> à partir de <span class="math notranslate nohighlight">\({\bf A}\)</span>. Donc :</p>
<p><span class="math notranslate nohighlight">\({\bf H^{(n-1)}} \cdots {\bf H^{(2)}} {\bf H^{(1)}}{\bf A} = {\bf R}\)</span></p>
<p>De plus les <span class="math notranslate nohighlight">\({\bf H^{(j)}}, j\in[\![1, n-1]\!]\)</span> sont orthogonales donc</p>
<p><span class="math notranslate nohighlight">\({\bf A} ={\bf {H^{(1)}}^\top}{\bf {H^{(2)}}^\top} \cdots  {\bf {H^{(n-1)}}^\top} {\bf R}\)</span></p>
<p>Le produit des matrices <span class="math notranslate nohighlight">\({\bf{ H^{(j)}}^\top}\)</span> est également une matrice orthogonale, et on pose</p>
<p><span class="math notranslate nohighlight">\({\bf Q} = {\bf {H^{(1)}}^\top}{\bf {H^{(2)}}^\top} \cdots  {\bf {H^{(n-1)}}^\top}\)</span></p>
<p>pour finalement obtenir  <span class="math notranslate nohighlight">\({\bf A} = {\bf QR}\)</span></p>
<p>On illustre cet algorithme sur les deux premières itérations :</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(j=1\)</span> :</p></li>
</ol>
<ul class="simple">
<li><p>On construit <span class="math notranslate nohighlight">\({\bf H^{(1)}}\)</span> telle que <span class="math notranslate nohighlight">\({\bf H^{(1)}A^{(1)}_{\bullet,1}}\)</span> =<span class="math notranslate nohighlight">\({\bf e_1}\)</span>, premier vecteur de la base canonique de <span class="math notranslate nohighlight">\(\mathbb R^n\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\({\bf A^{(2)}}={\bf H^{(1)}A^{(1)}} = \begin{pmatrix}{\|{\bf A^{(1)}_{\bullet,1}}\|}&amp;a^{(2)}_{12}&amp;*&amp;\cdots &amp;*\\0&amp;a^{(2)}_{22}&amp;*&amp;\cdots &amp;*\\0&amp;\vdots&amp;\vdots&amp;\vdots&amp;\vdots\\0&amp;a^{(2)}_{n2}&amp;*&amp;\cdots &amp;*\end{pmatrix}\)</span></p></li>
</ul>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(j=2\)</span> :</p></li>
</ol>
<ul class="simple">
<li><p>Soit <span class="math notranslate nohighlight">\({\bf f_2} = \begin{pmatrix}a^{(2)}_{22}\\\vdots\\a^{(2)}_{n2}\end{pmatrix}\in \mathbb R^{n-1}\)</span></p></li>
<li><p>On construit <span class="math notranslate nohighlight">\({\bf \tilde{H^{(2)}}}\in\mathcal{M}_{n-1}(\mathbb R)\)</span> telle que <span class="math notranslate nohighlight">\({\bf \tilde{H^{(2)}}f_2} = \|{\bf f_2}\| {\bf e^{(2)}_1}\)</span> avec <span class="math notranslate nohighlight">\({\bf e^{(2)}_1}\)</span> premier vecteur de la base canonique de <span class="math notranslate nohighlight">\(\mathbb R^{n-1}\)</span></p></li>
<li><p>On construit
<span class="math notranslate nohighlight">\({\bf H^{(2)}} =\left (
\begin{array}{l|l}
1&amp;{\bf 0}\\
\hline
{\bf 0} &amp; {\bf \tilde{H^{(2)}}}\\
\end{array}
\right )\in\mathcal{M}_n(\mathbb R)
\)</span> telle que
<span class="math notranslate nohighlight">\({\bf A^{(3)}}={\bf H^{(2)}A^{(2)}}\begin{pmatrix}{\|{\bf A^{(1)}_{\bullet,1}}\|}&amp;\ast&amp;\ast&amp;\cdots &amp;\ast\\0&amp;\|{\bf f_2}\|&amp;a^{(3)}_{23}&amp;\cdots &amp;\ast\\0&amp;0&amp;a^{(3)}_{33}&amp;\vdots&amp;\vdots\\0&amp;0&amp;a^{(3)}_{n3}&amp;\cdots &amp;*\end{pmatrix}\)</span></p></li>
</ul>
<p>L’implémentation peut se faire de la manière suivante.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">householder</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">copysign</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">u</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">u</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]))</span>
    <span class="k">return</span> <span class="n">H</span>

<span class="k">def</span> <span class="nf">qr</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="n">n</span><span class="p">)):</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">:,</span> <span class="n">i</span><span class="p">:]</span> <span class="o">=</span> <span class="n">householder</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">:,</span> <span class="n">i</span><span class="p">])</span>
        <span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Q</span><span class="p">,</span> <span class="n">A</span>


<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">51</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="o">-</span><span class="mi">68</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="o">-</span><span class="mi">41</span><span class="p">]])</span>
<span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;A=</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">Matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A=
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}12 &amp; -51 &amp; 4\\6 &amp; 167 &amp; -68\\-4 &amp; 24 &amp; -41\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Q=</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Q=

&lt;sympy.assumptions.ask.AssumptionKeys object at 0x105d92af0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;R=</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">Matrix</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>R=
</pre></div>
</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}-14.0 &amp; -21.0 &amp; 14.0\\2.26656300565782 \cdot 10^{-16} &amp; -175.0 &amp; 70.0\\4.72100990779067 \cdot 10^{-16} &amp; -7.43126796127797 \cdot 10^{-16} &amp; -35.0\end{matrix}\right]\end{split}\]</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "vbarra/anbook.git",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="mcl.html" title="précédent page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">précédent</p>
            <p class="prev-next-title">Moindres carrés linéaires</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="exomcl.html" title="suivant page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">suivant</p>
        <p class="prev-next-title">Exercices</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Vincent BARRA<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>